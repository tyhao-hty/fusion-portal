# T003 – 文章数据库加载与渲染

## 概述
实现文章内容从数据库的动态加载与渲染，支持 Markdown 编辑、分页展示、搜索过滤，并与前端/后台协同，形成统一的内容发布流程。

- **优先级**：🧩 中
- **当前状态**：🛠 进行中
- **关联系统**：Express API、Prisma、Next.js 文章页、后台编辑器（T002）

## 目标
1. 后端提供文章列表/详情 API，支持分页、排序、搜索；
2. 前端文章列表页与详情页读取 API 数据，渲染 Markdown/富文本；
3. 与 T002/T009 协同，确保文章内容在后台更新后实时反映至前端。

## 现状
- `GET /articles`、`GET /articles/:id` 已返回基础数据，但缺乏分页/搜索；
- 前端首页显示文章列表，可展示标题/内容片段，但尚未有详情页；
- 未接入 Markdown 渲染，缺乏元数据（作者、标签、更新时间等）。

## 待办清单
- [ ] 扩展后端 API：分页参数、关键词搜索、标签过滤；
- [ ] 调整 Prisma 模型以存储 Markdown/HTML 内容、摘要、封面；
- [ ] 引入 Markdown 渲染（如 `remark`/`rehype`）并处理安全性（XSS）；
- [ ] 创建文章详情页 (`app/articles/[id]/page.tsx`) 并优化加载状态；
- [ ] 在首页/列表页增加分页或无限滚动体验；
- [ ] 与 T002 后台形成内容同步流程（保存后触发重新验证/缓存更新）；
- [ ] 编写手动测试场景：创建文章 → 前端查看 → 搜索过滤。

## 依赖
- T002 中的文章编辑器与分类/标签设计；
- 数据库迁移与部署流程；
- CDN 或缓存策略（若使用 ISR/SSR）需与前端架构协同。
- 2025-11-05 同步：等待 T002 明确分类/标签/时间线关联字段，文章详情需暴露与 `/site/history` 时间线一致的年份/标签元数据。渲染层需求：
  - 列表接口响应应包含 `category`, `tags`, `publishedAt`, `excerpt`, `coverImageUrl`, `timelineYear`，供 `/site` 与 `/site/history` 共享 UI。
  - 详情页需返回 Markdown + `readingTime`、`lastEditedAt`，并暴露关联的 `timelineEvent`（若存在）。
  - 搜索/过滤应支持：关键词、分类、标签、年份（匹配 `timelineYear`），默认按 `publishedAt` desc。

## 验收标准
- API 支持分页 + 搜索并通过示例测试验证；
- 前端文章页面可渲染 Markdown，UI 与设计稿一致；
- 搜索与过滤功能响应及时，并提供错误/空态处理；
- QA 验证关键流程（创建、编辑、展示）无阻塞问题。

---

### 状态校验（2025-11-21 13:53 CST）
- 任务保持“进行中”状态，与 `Tasks Overview` 一致；目前仍在需求/设计阶段，无新增实现记录。
- 需在 T002 定稿分类/标签设计后同步更新本任务的接口和页面要求，并在 `dev_notes.md` 记录变更。
